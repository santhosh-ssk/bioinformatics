<html>
<head>
<title>Bio-informatics</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="jqu.js"></script>
<script src="search_engine.js"></script>
  <script src="novalfast_algorith.js"></script>
<link rel="stylesheet" type="text/css" href="https://rawgit.com/LeaVerou/awesomplete/gh-pages/awesomplete.css">
</head>
<body onload="return novalfastdata('NZ_MUGQ01000017.1,NZ_MUGQ01000019.1,NZ_CP014822.1,NZ_CP014823.1,NZ_CP014824.1,NZ_CP014825.1')">
<header><h1>Bio-Informatics</h1></header>
<div class="contanier" id="cont1">
<div class ="row">
<div class ="col-sm-6">
<select id="selectname" onchange="changed()">
<option value="name">search by name</option>
<option value="acc_no">search  y acc-no</option>
</select>
<input type="text" name="serachval" id="serachval">
<span id="searchbox"><input type="button" id="search" value="search" onclick="name_acc()"></span>
<br>
<input type="button" id="FOGSAA" value="FOGSAA">
<input type="button" id="tree" value="tree">
</div>
</div>
<div class ="row" id="sr">
<div class ="col-sm-12" id="accdisp">
<h3>Search Result</h3>
</div>
</div>
<div class ="row" id="gbf">
<div class ="col-sm-6" id="gbdisp">
<h4>GB</h4>
</div>
<div class ="col-sm-6" id="fastadisp">
<h4>FASTA</h4>
</div>
</div>
</div>
<div class="contanier" id="cont2">
<div class ="row">
<div class ="col-sm-6">
<h3>Compare by Acc_no/Sequence</h3>
<input type="text" id="serachbyacc">
<br>
</div>
<div class ="col-sm-6">
<h3>Compare by name</h3>
<input type="text" id="serachbyn1">
<input type="text" id="serachbyn2">
<input type="button" id="add" value="add">
<input type="button" id="compare" value="compare">
</div>
</div>
<div class ="row">
<div class ="col-sm-6">
<textarea rows="4" cols="40" id="serachbyseq">
</textarea>
</div>
</div>
<div class ="row">
<div class ="col-sm-12">
<h3>Phylogentic Tree</h3>
</div>
</div>
</div>
<div class="contanier" id="cont3">
<div class ="row">
<div class ="col-sm-6">
<h3>Compare by Acc_no/Sequence</h3>
<input type="text" id="serachbyacc">
<br>
</div>
<div class ="col-sm-6">
<h3>Compare by name</h3>
<input type="text" id="serachbyn1">
<input type="text" id="serachbyn2">
<input type="button" id="compare" value="compare">
</div>
</div>
<div class ="row">
<div class ="col-sm-6">
<h3>Sequence</h3>
</div>
<div class ="col-sm-6">
<h3>Graph</h3>
</div>
</div>
<script type="text/javascript" src="https://rawgit.com/LeaVerou/awesomplete/gh-pages/awesomplete.min.js"></script>
<script>
/*function changed()
{
//$("#searchbox").hide();
//$("#cont1").append('<input type="button" id="search1" value="search1" onclick="direct_acc()">');
}*/
function gene_detailfasta(gene_id){
          alert(gene_id);
          //$("#fastadisp").hide();
          $.post('https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=sequences&id='+gene_id+'&rettype=fasta&retmode=text',function(data){

              data=data.split('\n');
              for(var i=0;i<data.length;i++){
              $("#fastadisp").append("<p>"+data[i]+"</p>")
              }
          });
          return true;
        }
		function gene_detailgb(gene_id){
          alert(gene_id);
         // $("#accdisp").hide();
          $.post('https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=nuccore&id='+gene_id+'&rettype=gb&retmode=text',function(data){
              window.alert(data);
              data=data.split('\n');
              for(var i=0;i<data.length;i++){
              $("#gbdisp").append("<p>"+data[i]+"</p>")
              }
          });
          return true;
        }
		
function gene_detail(gene_id){
         gene_detailfasta(gene_id);
		 gene_detailgb(gene_id);
          return true;
        }
		
function gene_sum(genes){
          var n=genes.split(',');
          n=n.length;
          $.post('https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=nucleotide&id='+genes+'&retmode=json',function(data){

              for(i=0;i<n;i++){
                $("#accdisp").append("<a href='#' onclick='gene_detail(\""+data['result'][data['result']['uids'][i]]['caption']+"\")'>"+data['result'][data['result']['uids'][i]]['title']+"</a><br>")
               // alert("<a href='#' onclick='return gene_detail(\""+data['result'][data['result']['uids'][i]]['caption']+"\")'>"+data['result'][data['result']['uids'][i]]['title']+"</a><br>")
              }
			  });
        }
		/*
function direct_acc()
{
var name1=document.getElementById("serachval").value;
gene_detail(name1);
}		*/
function name_acc(){
choice=(document.getElementById("selectname").value);
var name1=document.getElementById("serachval").value;
//window.alert("inside");
if(choice=="name")
{$.ajax({
	url: "https://data.crookedly98.hasura-app.io/v1/query",
	contentType: "application/json",
	data: JSON.stringify({
      "type": "select",
      "args": {
            "table": "dna",
            "columns": [
                  "acc_no"
            ],
            "where": {
                  "name": {
                        "$eq": name1.value
                  }
            }
      }
	}),
	type: "POST",
	dataType: "json"
}).done(function(json) {
//window.alert("before");
window.alert(json[0]["acc_no"]);
gene_sum(json[0]["acc_no"]);
	// Handle Response
}).fail(function(xhr, status, errorThrown) {
	console.log("Error: " + errorThrown);
	console.log("Status: " + status);
	console.dir(xhr);
});
}
else gene_detail(name1);
}
</script>
</body>
</html>